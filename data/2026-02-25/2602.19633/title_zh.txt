TAPE: 語言模型代理中的工具導向自適應規劃與受限執行